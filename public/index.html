<!DOCTYPE html>
<html>
  <head>
    <title>Uniregistry</title>
    
    <link rel="stylesheet" href="../dependencies/bootstrap.min.css" />
    <link rel="stylesheet" href="../dependencies/">
    <script src="../dependencies/react.js"></script>
    <script src="../dependencies/JSXTransformer.js"></script>
    <script src="../dependencies/jquery.min.js"></script>
    <script src="../dependencies/underscore-min.js"></script>
    <link rel="stylesheet" href="base.css" />
  </head>
  <body>
 



    <div id="container">
        
    </div>
    


    <script type="text/jsx">
      
      var data = { "domains": [{
          "id": 1,
          "domain": "foodfighters.lol",
          "price": 1200, 
          "registrant_email": "john.smith@email.com"
        }, {
          "id": 2,
          "domain": "greendiamondsky.com",
          "price": 900, 
          "registrant_email": "admin@dealdomainer.com"
        }, {
          "id": 1,
          "domain": "selfdriving.cars",
          "price": 1600, 
          "registrant_email": "carl.sagan@aimotors.com"
        }]
      }


      var DomainTable = React.createClass({
        render: function() {
          var RowList = _.map(this.props.data.domains, function (domainObject) {
            return (
              <Row domain={domainObject.domain} price={domainObject.price} email={domainObject.registrant_email}> 
              </Row>
            );
          });
          return (
            <div className="domainTable col-sm-offset-2 col-sm-8">
          
              <table className="table table-striped-react">
                <tr>
                  <th className="domain-column">Domain Name</th>
                  <th className="check-column">Uniregistry</th> 
                  <th className="price-column">Price</th>
                </tr>
                {RowList}
              </table>
            </div>
          );
        }
      });

      var Row = React.createClass({
        editModal: function() {
          React.render(
            <DomainDetail email={this.props.email} domain={this.props.domain} price={this.props.price} />,
            document.getElementById('container')
          );
        },
        render: function() {
        function endsWith(string, suffix) {
          return string.indexOf(suffix, string.length - suffix.length) !== -1;
        }
        var check = ""
        if (endsWith(this.props.domain, ".lol") || endsWith(this.props.domain, ".cars")){
          check = "yes"
        }
          return (
            <tr>
              <td className="table-domain" onClick={this.editModal}> {this.props.domain}</td>
              <td className="table-check"> {check} </td>
              <td className="table-price"> ${(this.props.price/100).toFixed(2)}</td>
            </tr>
          );
        }
      });

      var DomainDetail = React.createClass({
        getInitialState: function() {
          return {domain: this.props.domain, email: this.props.email, price: (this.props.price/100).toFixed(2)};
        },
        handleChange: function(event) {
          var data = {}
          data[event.target.name] = event.target.value
          this.setState(data);

        },
        render: function () {

          return(
            <div className="domainForm col-sm-offset-2 col-sm-8">
              <form className="form-horizontal">

                <div className="form-group">
                  <label for="domain-form" className="col-xs-3 control-label">Domain name</label>
                  <div className="col-xs-9">
                    <input type="text" className="form-control" id="domain-form" name="domain" value={this.state.domain} onChange={this.handleChange}/>
                  </div>
                </div>
                <div className="form-group">
                  <label for="email-form" className="col-xs-3 control-label">Registran Email</label>
                  <div className="col-xs-9">
                    <input type="text" className="form-control" id="email-form" name="email" value={this.state.email} onChange={this.handleChange}/>
                  </div>
                </div>
                <div className="form-group">
                  <label for="price-form" className="col-xs-3 control-label">Price</label>
                  <div className="col-xs-9">
                    <input type="text" className="form-control" id="price-form" name="price" value={this.state.price} onChange={this.handleChange}/>
                  </div>
                </div>
                <div className="form-group">
                  <div className="col-xs-offset-3 col-xs-9">
                    <button type="submit" className="btn btn-default save-button">Save changes</button>
                  </div>
                </div>

               
              </form>
            </div>
          )
        }
 
      })



      React.render(
        <DomainTable data={data} />,
        document.getElementById('container')
      );






    </script>

  </body>  

</html>
